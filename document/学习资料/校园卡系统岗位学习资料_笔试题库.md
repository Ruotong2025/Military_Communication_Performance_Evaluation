# 校园卡系统岗位笔试题库

## 一、数据库题目

### 1.1 选择题

**1. 下列关于数据库事务ACID特性的描述，错误的是？**
A. 原子性保证事务中的操作要么全部成功，要么全部失败
B. 一致性保证事务执行前后数据保持一致状态
C. 隔离性保证并发事务之间完全不会相互影响
D. 持久性保证事务提交后数据永久保存

**答案：C**
解析：隔离性是指并发事务之间的影响程度由隔离级别控制，并非完全不影响。

**2. 在MySQL中，哪个存储引擎支持事务？**
A. MyISAM
B. InnoDB
C. Memory
D. CSV

**答案：B**

**3. 以下哪个索引类型查询速度最快？**
A. 全表扫描
B. 索引扫描
C. 范围扫描
D. 常量查询

**答案：D**

**4. SQL语句中，用于去除重复记录的关键字是？**
A. UNIQUE
B. DISTINCT
C. DIFFERENT
D. REMOVE

**答案：B**

**5. 下列关于索引的说法，正确的是？**
A. 索引越多越好
B. 索引会降低查询速度
C. 索引会占用额外的存储空间
D. 所有字段都应该建立索引

**答案：C**

### 1.2 填空题

**1. 数据库的三级模式结构包括外模式、______ 和内模式。**
答案：模式（或逻辑模式）

**2. SQL语言中，______ 语句用于查询数据，______ 语句用于插入数据。**
答案：SELECT, INSERT

**3. 在关系数据库中，______ 用于唯一标识表中的每一行数据。**
答案：主键（Primary Key）

**4. MySQL中，______ 命令用于查看表结构。**
答案：DESC 或 DESCRIBE

**5. 数据库备份方式包括完全备份、______ 备份和差异备份。**
答案：增量

### 1.3 SQL编程题

**题目1：查询每个学院学生的平均消费金额**
```sql
-- 表结构
students(student_id, name, department)
campus_cards(card_id, student_id, balance)
transactions(transaction_id, card_id, amount, transaction_type, transaction_time)

-- 答案
SELECT 
    s.department,
    COUNT(DISTINCT s.student_id) as student_count,
    AVG(t.amount) as avg_consume
FROM students s
INNER JOIN campus_cards c ON s.student_id = c.student_id
INNER JOIN transactions t ON c.card_id = t.card_id
WHERE t.transaction_type = 'consume'
GROUP BY s.department
ORDER BY avg_consume DESC;
```

**题目2：查找连续3天都有消费的学生**
```sql
SELECT DISTINCT s.student_id, s.name
FROM students s
INNER JOIN campus_cards c ON s.student_id = c.student_id
WHERE EXISTS (
    SELECT 1 FROM transactions t1
    WHERE t1.card_id = c.card_id
      AND t1.transaction_type = 'consume'
      AND DATE(t1.transaction_time) = CURDATE()
)
AND EXISTS (
    SELECT 1 FROM transactions t2
    WHERE t2.card_id = c.card_id
      AND t2.transaction_type = 'consume'
      AND DATE(t2.transaction_time) = DATE_SUB(CURDATE(), INTERVAL 1 DAY)
)
AND EXISTS (
    SELECT 1 FROM transactions t3
    WHERE t3.card_id = c.card_id
      AND t3.transaction_type = 'consume'
      AND DATE(t3.transaction_time) = DATE_SUB(CURDATE(), INTERVAL 2 DAY)
);
```

**题目3：创建存储过程实现校园卡充值**
```sql
DELIMITER //
CREATE PROCEDURE recharge_card(
    IN p_card_id VARCHAR(20),
    IN p_amount DECIMAL(10,2),
    OUT p_result VARCHAR(50)
)
BEGIN
    DECLARE v_status VARCHAR(10);
    DECLARE v_balance DECIMAL(10,2);
    
    -- 检查卡片状态
    SELECT status, balance INTO v_status, v_balance
    FROM campus_cards
    WHERE card_id = p_card_id;
    
    IF v_status != 'active' THEN
        SET p_result = '卡片状态异常';
    ELSE
        -- 开始事务
        START TRANSACTION;
        
        -- 更新余额
        UPDATE campus_cards
        SET balance = balance + p_amount
        WHERE card_id = p_card_id;
        
        -- 记录交易
        INSERT INTO transactions (card_id, amount, transaction_type, transaction_time)
        VALUES (p_card_id, p_amount, 'recharge', NOW());
        
        COMMIT;
        SET p_result = '充值成功';
    END IF;
END //
DELIMITER ;
```

---

## 二、计算机网络题目

### 2.1 选择题

**1. OSI模型中，负责路由选择的是哪一层？**
A. 数据链路层
B. 网络层
C. 传输层
D. 应用层

**答案：B**

**2. TCP协议建立连接需要几次握手？**
A. 1次
B. 2次
C. 3次
D. 4次

**答案：C**

**3. 下列哪个IP地址是私有地址？**
A. 8.8.8.8
B. 192.168.1.1
C. 114.114.114.114
D. 202.96.128.86

**答案：B**

**4. 子网掩码255.255.255.0对应的CIDR表示是？**
A. /8
B. /16
C. /24
D. /32

**答案：C**

**5. HTTP协议默认使用的端口号是？**
A. 21
B. 22
C. 80
D. 443

**答案：C**

### 2.2 填空题

**1. TCP/IP模型分为四层，从下到上依次是网络接口层、______ 层、传输层和应用层。**
答案：网络层（或IP层）

**2. DNS协议的作用是将 ______ 转换为IP地址。**
答案：域名

**3. 在交换机上，______ 端口用于连接不同VLAN之间的通信。**
答案：Trunk

**4. ping命令使用的是 ______ 协议。**
答案：ICMP

**5. 192.168.1.0/26网络可以容纳 ______ 个主机地址。**
答案：62（64-2）

### 2.3 计算题

**题目1：子网划分**
将192.168.10.0/24划分为4个子网，写出每个子网的网络地址、广播地址和可用IP范围。

**答案：**
需要4个子网，2² = 4，借2位，新掩码/26

子网1：
- 网络地址：192.168.10.0/26
- 可用IP：192.168.10.1 ~ 192.168.10.62
- 广播地址：192.168.10.63

子网2：
- 网络地址：192.168.10.64/26
- 可用IP：192.168.10.65 ~ 192.168.10.126
- 广播地址：192.168.10.127

子网3：
- 网络地址：192.168.10.128/26
- 可用IP：192.168.10.129 ~ 192.168.10.190
- 广播地址：192.168.10.191

子网4：
- 网络地址：192.168.10.192/26
- 可用IP：192.168.10.193 ~ 192.168.10.254
- 广播地址：192.168.10.255

**题目2：VLSM可变长子网划分**
某校园网需要规划IP地址，要求如下：
- 教学楼A：需要500个地址
- 教学楼B：需要200个地址
- 办公楼：需要50个地址
- 服务器区：需要10个地址

使用172.16.0.0/16进行规划。

**答案：**
- 教学楼A：需要512个地址，使用/23
  172.16.0.0/23（172.16.0.1 ~ 172.16.1.254）

- 教学楼B：需要256个地址，使用/24
  172.16.2.0/24（172.16.2.1 ~ 172.16.2.254）

- 办公楼：需要64个地址，使用/26
  172.16.3.0/26（172.16.3.1 ~ 172.16.3.62）

- 服务器区：需要16个地址，使用/28
  172.16.3.64/28（172.16.3.65 ~ 172.16.3.78）

### 2.4 配置题

**题目：在交换机上配置VLAN**
要求：
1. 创建VLAN 10（教学区）和VLAN 20（办公区）
2. 将端口1-10分配到VLAN 10
3. 将端口11-20分配到VLAN 20
4. 将端口24配置为Trunk端口

**答案：**
```cisco
# 创建VLAN
Switch(config)# vlan 10
Switch(config-vlan)# name Teaching
Switch(config-vlan)# exit

Switch(config)# vlan 20
Switch(config-vlan)# name Office
Switch(config-vlan)# exit

# 配置接入端口
Switch(config)# interface range fastethernet 0/1-10
Switch(config-if-range)# switchport mode access
Switch(config-if-range)# switchport access vlan 10
Switch(config-if-range)# exit

Switch(config)# interface range fastethernet 0/11-20
Switch(config-if-range)# switchport mode access
Switch(config-if-range)# switchport access vlan 20
Switch(config-if-range)# exit

# 配置Trunk端口
Switch(config)# interface fastethernet 0/24
Switch(config-if)# switchport mode trunk
Switch(config-if)# switchport trunk allowed vlan 10,20
Switch(config-if)# exit

# 保存配置
Switch# copy running-config startup-config
```

---

## 三、操作系统题目

### 3.1 选择题

**1. 进程的三种基本状态是？**
A. 就绪、运行、等待
B. 新建、就绪、运行
C. 运行、阻塞、终止
D. 就绪、运行、阻塞

**答案：D**

**2. Linux中，哪个命令用于查看当前目录？**
A. cd
B. ls
C. pwd
D. dir

**答案：C**

**3. 文件权限rwxr-xr--对应的数字表示是？**
A. 755
B. 754
C. 644
D. 744

**答案：B**

**4. 下列哪个不是进程调度算法？**
A. 先来先服务
B. 时间片轮转
C. 最短寻道时间优先
D. 优先级调度

**答案：C**
解析：最短寻道时间优先是磁盘调度算法

**5. Linux中，哪个命令用于查看进程？**
A. top
B. ps
C. netstat
D. A和B都对

**答案：D**

### 3.2 填空题

**1. Linux中，______ 命令用于修改文件权限。**
答案：chmod

**2. 进程间通信的方式包括管道、消息队列、______ 和共享内存。**
答案：信号量

**3. Linux中，______ 目录存放系统日志文件。**
答案：/var/log

**4. 虚拟内存的页面置换算法中，______ 算法选择最近最少使用的页面进行置换。**
答案：LRU

**5. systemctl ______ mysql 命令用于启动MySQL服务。**
答案：start

### 3.3 命令题

**题目1：使用Linux命令完成以下操作**
1. 查看当前系统内存使用情况
2. 查找/var/log目录下所有.log文件
3. 统计/etc/passwd文件的行数
4. 查看MySQL进程是否运行
5. 查看80端口是否被占用

**答案：**
```bash
# 1. 查看内存
free -h

# 2. 查找日志文件
find /var/log -name "*.log"

# 3. 统计行数
wc -l /etc/passwd

# 4. 查看MySQL进程
ps aux | grep mysql

# 5. 查看80端口
netstat -tuln | grep :80
# 或
ss -tuln | grep :80
```

**题目2：编写Shell脚本**
编写一个脚本，监控磁盘使用率，如果超过80%则发送告警邮件。

**答案：**
```bash
#!/bin/bash

THRESHOLD=80
EMAIL="admin@example.com"

# 获取磁盘使用率
disk_usage=$(df -h / | tail -1 | awk '{print $5}' | cut -d'%' -f1)

# 判断是否超过阈值
if [ $disk_usage -gt $THRESHOLD ]; then
    echo "警告：磁盘使用率已达 ${disk_usage}%" | \
    mail -s "磁盘空间告警" $EMAIL
    
    echo "[$(date)] 磁盘使用率: ${disk_usage}% - 已发送告警" >> /var/log/disk_monitor.log
else
    echo "[$(date)] 磁盘使用率: ${disk_usage}% - 正常" >> /var/log/disk_monitor.log
fi
```

---

## 四、综合案例分析题

### 案例1：数据库性能问题

**场景描述：**
校园卡系统在用餐高峰期（11:30-12:30）出现严重卡顿，查询交易记录需要10秒以上。数据库服务器配置：8核CPU，16GB内存，transactions表有500万条记录。

**问题：**
1. 可能的原因有哪些？
2. 如何排查问题？
3. 提出优化方案。

**参考答案：**

**1. 可能原因：**
- 缺少索引或索引失效
- SQL语句未优化
- 数据库连接数不足
- 服务器资源不足
- 表数据量过大未分区

**2. 排查步骤：**
```sql
-- 查看慢查询
SHOW VARIABLES LIKE 'slow_query%';

-- 分析查询执行计划
EXPLAIN SELECT * FROM transactions 
WHERE card_id = 'C001' 
AND transaction_time > '2024-01-01';

-- 查看表索引
SHOW INDEX FROM transactions;

-- 查看数据库连接数
SHOW PROCESSLIST;

-- 查看表大小
SELECT 
    table_name,
    ROUND(((data_length + index_length) / 1024 / 1024), 2) AS 'Size (MB)'
FROM information_schema.tables
WHERE table_schema = 'campus_card_db';
```

**3. 优化方案：**
```sql
-- 添加索引
CREATE INDEX idx_card_time ON transactions(card_id, transaction_time);
CREATE INDEX idx_time ON transactions(transaction_time);

-- 分区表（按月分区）
ALTER TABLE transactions
PARTITION BY RANGE (YEAR(transaction_time) * 100 + MONTH(transaction_time)) (
    PARTITION p202401 VALUES LESS THAN (202402),
    PARTITION p202402 VALUES LESS THAN (202403),
    PARTITION p202403 VALUES LESS THAN (202404)
);

-- 归档历史数据
CREATE TABLE transactions_archive LIKE transactions;
INSERT INTO transactions_archive 
SELECT * FROM transactions 
WHERE transaction_time < DATE_SUB(NOW(), INTERVAL 1 YEAR);

DELETE FROM transactions 
WHERE transaction_time < DATE_SUB(NOW(), INTERVAL 1 YEAR);

-- 优化数据库配置
-- my.cnf
max_connections = 500
innodb_buffer_pool_size = 8G
query_cache_size = 256M
```

### 案例2：网络故障排查

**场景描述：**
某栋宿舍楼的所有校园卡刷卡设备（共20台）突然全部离线，无法进行消费。其他楼栋设备正常。

**问题：**
1. 列出详细的排查步骤
2. 可能的故障点有哪些？
3. 如何快速恢复服务？

**参考答案：**

**1. 排查步骤：**
```bash
# 步骤1：检查设备网络连通性
ping 192.168.30.101  # 设备IP
ping 192.168.30.102

# 步骤2：检查网关连通性
ping 192.168.30.1    # 网关IP

# 步骤3：检查核心交换机
ping 192.168.10.1    # 核心交换机管理IP

# 步骤4：登录交换机查看端口状态
ssh admin@192.168.10.10
show interface status
show vlan

# 步骤5：查看设备日志
tail -f /var/log/device_monitor.log

# 步骤6：检查DHCP服务
systemctl status isc-dhcp-server
```

**2. 可能故障点：**
- 楼栋交换机故障或断电
- 网线损坏或松动
- VLAN配置错误
- 交换机端口被关闭
- DHCP服务异常
- 防火墙规则阻断

**3. 快速恢复方案：**
```
方案A：交换机故障
1. 准备备用交换机
2. 更换故障交换机
3. 恢复配置
4. 测试设备连通性

方案B：配置错误
1. 登录交换机
2. 检查VLAN配置
3. 修正配置错误
4. 保存配置

方案C：临时方案
1. 启用备用网络链路
2. 修改设备网络配置
3. 恢复业务
4. 后续修复主链路
```

### 案例3：系统安全事件

**场景描述：**
监控系统发现数据库服务器出现大量异常登录尝试，怀疑遭受暴力破解攻击。

**问题：**
1. 如何确认是否被攻击？
2. 采取哪些应急措施？
3. 如何加强安全防护？

**参考答案：**

**1. 确认攻击：**
```bash
# 查看登录日志
tail -n 1000 /var/log/auth.log | grep "Failed password"

# 统计失败登录次数
grep "Failed password" /var/log/auth.log | \
awk '{print $11}' | sort | uniq -c | sort -nr

# 查看数据库连接
mysql -e "SHOW PROCESSLIST;"

# 查看防火墙日志
tail -f /var/log/ufw.log
```

**2. 应急措施：**
```bash
# 封禁攻击IP
ufw deny from 192.168.1.100

# 修改SSH端口
vi /etc/ssh/sshd_config
# Port 22 改为 Port 2222
systemctl restart sshd

# 禁用root远程登录
vi /etc/ssh/sshd_config
# PermitRootLogin no

# 限制数据库访问
# 修改MySQL配置，只允许内网访问
bind-address = 192.168.1.100

# 修改数据库密码
ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewStrongPassword123!';
```

**3. 加强防护：**
```bash
# 安装fail2ban
apt-get install fail2ban

# 配置fail2ban
vi /etc/fail2ban/jail.local
[sshd]
enabled = true
maxretry = 3
bantime = 3600

# 配置防火墙规则
ufw default deny incoming
ufw default allow outgoing
ufw allow 2222/tcp
ufw allow from 192.168.1.0/24 to any port 3306
ufw enable

# 启用审计日志
vi /etc/mysql/my.cnf
[mysqld]
log_error = /var/log/mysql/error.log
general_log = 1
general_log_file = /var/log/mysql/general.log

# 定期备份
crontab -e
0 2 * * * /scripts/backup_database.sh
```

---

## 五、模拟试卷

### 模拟试卷一（100分，120分钟）

**一、选择题（每题2分，共30分）**

1. 关系数据库的第三范式要求消除？
   A. 部分依赖  B. 传递依赖  C. 多值依赖  D. 函数依赖

2. TCP协议属于OSI模型的哪一层？
   A. 网络层  B. 传输层  C. 会话层  D. 应用层

3. Linux中，chmod 755的含义是？
   A. 所有人可读写执行  B. 所有者可读写执行，其他人可读执行
   C. 所有者可读写，其他人可读  D. 所有人可读执行

（省略其他12题...）

**二、填空题（每空2分，共20分）**

1. SQL语言分为DDL、DML、______ 和DCL四类。
2. 子网掩码255.255.255.192对应的CIDR表示是 ______。
3. Linux中，______ 命令用于查看磁盘使用情况。

（省略其他7题...）

**三、简答题（每题10分，共30分）**

1. 简述数据库索引的作用及使用原则。
2. 解释TCP三次握手的过程。
3. 列举Linux系统性能监控的常用命令及作用。

**四、综合应用题（20分）**

某校园卡系统需要设计数据库，包含以下实体：
- 学生（学号、姓名、院系、年级）
- 校园卡（卡号、学号、余额、状态）
- 商户（商户号、商户名、类型）
- 交易记录（交易号、卡号、商户号、金额、时间）

要求：
1. 设计ER图（10分）
2. 写出建表SQL语句（10分）

---

**学习建议**：
1. 每天练习10-20道题目
2. 重点掌握SQL编程和网络计算
3. 多做综合案例分析题
4. 总结错题和知识盲区
5. 模拟考试环境进行测试
