# 军事通信效能评估 - 灰色层次评估法

## 文件说明

- **原文件**: `Military_Communication_Performace_Evaluation_MaxMin.py` (组合赋权法 - 加权求和)
- **新文件**: `Military_Communication_Performace_Evaluation_Grey.py` (灰色层次评估法)

## 核心修改内容

### 一、评估方法对比

| 项目 | 原方法（加权求和） | 新方法（灰色层次评估） |
|------|-------------------|---------------------|
| **指标标准化** | Min-Max (0-100分) | Min-Max (0-100分) ✅相同 |
| **指标层权重** | 熵权法 | 熵权法 ✅相同 |
| **维度层权重** | AHP | AHP ✅相同 |
| **打分方法** | 直接加权求和 | 白化权函数+灰色评估系数 🔄改变 |
| **综合评分** | Σ(指标值×权重) | Σ(灰色评估权×灰类代表值) 🔄改变 |

### 二、灰色层次评估法核心要素

#### 1. 灰类定义（10分制）

| 灰类 | 等级 | 灰数区间 | 灰类代表值 | 100分制对应 |
|------|------|----------|-----------|------------|
| e=1 | 优秀 | ⊗₁∈[9, ∞) | 9.5 | 90-100分 |
| e=2 | 良好 | ⊗₂∈[0, 7, 10] | 7.0 | 70-90分 |
| e=3 | 中等 | ⊗₃∈[0, 5, 8] | 5.0 | 50-70分 |
| e=4 | 较差 | ⊗₄∈[0, 1, 5] | 1.0 | 0-50分 |

#### 2. 白化权函数

```python
# 第1灰类"优秀"：⊗₁∈[9, ∞) - 上限测度
def whitening_function_1(x):
    if x < 7:
        return 0
    elif 7 <= x < 9:
        return (x - 7) / 2
    else:  # x >= 9
        return 1

# 第2灰类"良好"：⊗₂∈[0, 7, 10] - 中间测度
def whitening_function_2(x):
    if x < 5:
        return 0
    elif 5 <= x < 7:
        return (x - 5) / 2
    elif 7 <= x <= 10:
        return (10 - x) / 3
    else:  # x > 10
        return 0

# 第3灰类"中等"：⊗₃∈[0, 5, 8] - 中间测度
def whitening_function_3(x):
    if x < 3:
        return 0
    elif 3 <= x < 5:
        return (x - 3) / 2
    elif 5 <= x <= 8:
        return (8 - x) / 3
    else:  # x > 8
        return 0

# 第4灰类"较差"：⊗₄∈[0, 1, 5] - 下限测度
def whitening_function_4(x):
    if x <= 1:
        return 1
    elif 1 < x < 3:
        return (3 - x) / 2
    else:  # x >= 3
        return 0
```

#### 3. 评估流程

```
步骤1: 数据标准化（0-100分）
  ↓
步骤2: 转换到10分制（÷10）
  ↓
步骤3: 计算白化权函数值
  对每个指标值x，计算 f₁(x), f₂(x), f₃(x), f₄(x)
  ↓
步骤4: 归一化得到灰色评估权向量
  r = [f₁, f₂, f₃, f₄] / Σ(f₁+f₂+f₃+f₄)
  ↓
步骤5: 使用熵权法局部权重计算维度层灰色评估权向量
  R_维度 = Σ(熵权重ⱼ × rⱼ)
  ↓
步骤6: 使用AHP维度权重计算总体灰色评估权向量
  R_总体 = Σ(AHP权重_c × R_c)
  ↓
步骤7: 计算综合得分（10分制）
  S = R_总体 · [9.5, 7.0, 5.0, 1.0]ᵀ
  ↓
步骤8: 转换回100分制（×10）
  最终得分 = S × 10
```

### 三、代码修改位置

#### 修改1: 文件头部说明（第1-18行）
- 修改评估方法描述为"灰色层次评估法"

#### 修改2: 步骤5.2 - 定义白化权函数（约第540行）
**原代码**:
```python
# 5.2 组合AHP维度权重和熵权法指标权重
final_weights = {}
for i, dim_code in enumerate(dim_codes_ordered):
    dim_weight = criteria_weights[i]
    for indicator in dim_info['indicators']:
        total_weight = dim_weight * entropy_weight
        final_weights[code] = total_weight
```

**新代码**:
```python
# 5.2 定义灰色层次评估法的白化权函数
def whitening_function_1(x): ...
def whitening_function_2(x): ...
def whitening_function_3(x): ...
def whitening_function_4(x): ...
GREY_CLASS_VALUES = [9.5, 7.0, 5.0, 1.0]
WHITENING_FUNCTIONS = [...]
```

#### 修改3: 步骤6 - 灰色层次评估计算（约第580行）
**原代码**:
```python
# 步骤6: 综合评分计算
# 使用混合权重（AHP维度权重 × 熵权法指标权重）
df_scores = df_normalized.copy()
for dim_code in dim_codes_ordered:
    dim_score = 0
    for indicator in dim_info['indicators']:
        dim_score += df_normalized[code] * weight
    df_scores[f'{dim_code}_score'] = dim_score / dim_total_weight
df_scores['total_score'] = Σ(维度得分 × AHP权重)
```

**新代码**:
```python
# 步骤6: 灰色层次评估计算
# 6.1 计算指标层灰色评估系数
def calculate_grey_coefficients(value_100):
    value_10 = value_100 / 10.0
    f_values = [f(value_10) for f in WHITENING_FUNCTIONS]
    return [f / sum(f_values) for f in f_values]

# 6.2 计算维度层灰色评估
for dim_code in dim_codes_ordered:
    dim_grey_vector = Σ(熵权重 × 指标灰色评估权向量)
    dim_score = dim_grey_vector · GREY_CLASS_VALUES × 10

# 6.3 计算目标层综合评估
total_grey_vector = Σ(AHP权重 × 维度灰色评估权向量)
total_score = total_grey_vector · GREY_CLASS_VALUES × 10
```

#### 修改4: 评估等级判定（约第750行）
**原代码**:
```python
def get_grade(score):
    if score >= 90: return '优秀'
    elif score >= 80: return '良好'
    elif score >= 70: return '中等'
    elif score >= 60: return '及格'
    else: return '较差'
```

**新代码**:
```python
def get_grade(score):
    if score >= 90: return '优秀'    # 对应10分制的9分以上
    elif score >= 70: return '良好'  # 对应10分制的7分以上
    elif score >= 50: return '中等'  # 对应10分制的5分以上
    else: return '较差'               # 对应10分制的5分以下
```

#### 修改5: 详细报告输出（约第800行）
**新增**: 显示灰色评估权向量
```python
grey_vector = [row[f'total_grey_{i}'] for i in range(1, 5)]
print(f"灰色评估权向量: [{grey_vector[0]:.3f}, {grey_vector[1]:.3f}, {grey_vector[2]:.3f}, {grey_vector[3]:.3f}]")
print(f"  → 优秀倾向: {grey_vector[0]*100:.1f}%")
print(f"  → 良好倾向: {grey_vector[1]*100:.1f}%")
print(f"  → 中等倾向: {grey_vector[2]*100:.1f}%")
print(f"  → 较差倾向: {grey_vector[3]*100:.1f}%")
```

#### 修改6: 可视化说明文字（约第1050行、第1200行）
- 将"算法得分"改为"灰色评估得分"
- 更新说明文字，强调灰色评估法的特点

### 四、输出结果示例

```
================================================================================
评估结果汇总
================================================================================

综合排名:
排名  测试批次  综合得分  等级    可靠性  安全性  抗干扰性  ...
1     test_15   88.5     良好    86.4    88.5    85.2     ...
2     test_08   85.8     良好    84.2    87.1    83.5     ...
...

详细评估报告:
测试批次: test_15
综合得分: 88.5分
评估等级: 良好
排名: 1/21
灰色评估权向量: [0.520, 0.300, 0.120, 0.060]
  → 优秀倾向: 52.0%
  → 良好倾向: 30.0%
  → 中等倾向: 12.0%
  → 较差倾向: 6.0%

维度得分:
  可靠性  : 86.40分  灰色评估: [0.50, 0.24, 0.16, 0.10]
  安全性  : 88.50分  灰色评估: [0.60, 0.30, 0.10, 0.00]
  ...
```

### 五、运行方法

```bash
# 运行灰色层次评估法版本
python Military_Communication_Performace_Evaluation_Grey.py

# 对比运行原版本
python Military_Communication_Performace_Evaluation_MaxMin.py
```

### 六、优势对比

#### 原方法（加权求和）优势：
- ✅ 简单直观，易于理解
- ✅ 计算速度快
- ✅ 结果确定性强

#### 新方法（灰色层次评估）优势：
- ✅ 处理不确定性和模糊性
- ✅ 通过白化权函数更合理地评价指标
- ✅ 灰色评估权向量提供更丰富的信息
- ✅ 符合灰色系统理论，更适合信息不完全的场景
- ✅ 评估结果更加稳健

### 七、注意事项

1. **数据库连接**: 确保数据库配置正确
2. **依赖库**: 需要安装 `mysql-connector-python`, `pandas`, `numpy`, `matplotlib`
3. **中文显示**: 需要系统安装中文字体（SimHei或Microsoft YaHei）
4. **评估等级**: 灰色评估法的等级划分与原方法不同，注意对比
5. **灰色评估权向量**: 提供了各灰类的隶属度信息，可用于深入分析

### 八、技术支持

如有问题，请检查：
1. 白化权函数定义是否正确
2. 灰类代表值是否合理
3. 10分制与100分制的转换是否正确
4. 灰色评估权向量的归一化是否正确

---

**创建时间**: 2026-02-12
**版本**: v1.0
**作者**: AI Assistant
